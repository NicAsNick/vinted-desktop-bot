<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tasks</title>
    <script
      src="https://kit.fontawesome.com/769e6be0c4.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="tasks.css" />
    <script src="eel.js"></script>
    <script>
      /* EEL */

      function start() {
        window.addEventListener("load", () => {
          eel.actualisation();
        });
      }
      start()

      function send_modal() {
        name = document.querySelector(".input_task").value;
        link_vinted = document.querySelector(".input_vinted").value;

        if (name != "" && link_vinted != "") {
          eel.task(name, link_vinted);
          document.getElementById("myModal").style.display = "none";
          location.reload()
        }
      }

      function addText(titlename, vintedlink) {
        var container_tasks = document.querySelector(".container_tasks");

        var task = document.createElement("div");
        task.className = "task";

        var green = document.createElement("div");
        green.className = "green";

        var container_title_link = document.createElement("div");
        container_title_link.className = "title_link";

        var title_link = document.createElement("p");
        title_link.innerHTML = titlename;

        var link_vinted = document.createElement("a");
        link_vinted.innerHTML = vintedlink;

        var arrow = document.createElement("div");
        arrow.className = "arrow";
        var icon_arrow = document.createElement("i");
        icon_arrow.className = "fa-solid fa-angle-right";

        container_tasks.appendChild(task);
        task.appendChild(green);
        task.appendChild(container_title_link);

        container_title_link.appendChild(title_link);
        container_title_link.appendChild(link_vinted);

        arrow.appendChild(icon_arrow);
        task.appendChild(arrow);
      }
      eel.expose(addText);
    </script>
  </head>
  <body>
    <header>
      <div class="logo">
        <p>Vinted BOT</p>
      </div>
      <div class="pseudo">
        <p class="content"></p>
        <p>DISCORDUSER#0000</p>
      </div>
    </header>

    <aside>
      <div class="menu">
        <a href="index.html"
          ><i class="fa-solid fa-chart-line"></i> Dashboard</a
        >
        <a href="tasks.html"><i class="fa-solid fa-list-check"></i> Tasks</a>
        <a href="#"><i class="fa-solid fa-gear"></i> Settings</a>
      </div>
    </aside>

    <main>
      <div class="container_top">
        <p class="total_running">
          Total running : <span class="number_running">2</span>
        </p>
        <p class="new_task" id="myBtn" onclick="">
          Create new task <i class="fa-solid fa-plus"></i>
        </p>
      </div>

      <div class="container_tasks">
        <!-- <div class="task">
          <div class="green"></div>
          <div class="title_link">
            <p>Title</p>
            <a href="#"
              >https://www.vinted.fr/vetements?search_text=short%20Ralph%20lauren&search_id=5014555485&time=1649711714</a
            >
          </div>
          <div class="arrow"><i class="fa-solid fa-angle-right"></i></div>
        </div> -->
      </div>
    </main>

    <!-- MODAL -->

    <!-- The Modal -->
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <p class="title_modal">Create a new task</p>
        <div class="form">
          <input class="input_task" type="text" placeholder="Task name" />
          <input class="input_vinted" type="text" placeholder="Vinted link" />
          <button class="done_modal" onclick="send_modal()">Done</button>
        </div>
      </div>
    </div>

    <script>
      /* MODAL */

      var modal = document.getElementById("myModal");

      // Get the button that opens the modal
      var btn = document.getElementById("myBtn");

      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];

      // When the user clicks on the button, open the modal
      btn.onclick = function () {
        modal.style.display = "block";
      };

      // When the user clicks on <span> (x), close the modal
      span.onclick = function () {
        modal.style.display = "none";
      };

      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function (event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };
    </script>
  </body>
</html>
